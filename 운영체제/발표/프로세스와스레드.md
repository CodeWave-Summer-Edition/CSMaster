#Process & Thread
## Process
**프로세스(Process)란 CPU 스케줄링의 대상이 되는 작업(Task)의 단위.**

### 프로그램의 컴파일 과정
C언어   
![image](https://github.com/CodeWave-Summer-Edition/CSMaster/assets/43038815/a9f98c15-d7b8-4613-9242-844800c2fa65)

### ※컴파일러 VS 인터프리터
#### 컴파일
- 전처리 과정을 통해 기계어로 변환하는 과정.
#### 컴파일러
- 위의 컴파일 과정을 진행시켜주는 도구
- 전체 파일을 스캔하여 한번에 번역한다.
- 스캔하여 번역하는 과정에서 오류를 검출할 수 있기 때문에 실행 전에 오류를 검출할 수 있음.
- 스캔하여 컴파일된 파일을 만들고나면, 실행하는 시간이 빨라짐.
- 컴파일러를 사용하는 대표적인 언어 : C, C++
#### 인터프리터
- 프로그램 실행 시 한 번에 한 문장씩 번역하여 기계어로 변환시켜주는 도구.
- 한 번에 한 문장씩 변역 후 실행하기 때문에 실행시간이 느림.
- 목적코드 생성, 링킹 과정을 거치지 않기 때문에 메모리 효율이 좋음.
- 프로그램을 실행하며 기계어로 번역하기 때문에, 실행 전 오류를 검출하지 못하고, 코드가 실행되어야 오류를 검출할 수 있다.
- 인터프리터를 사용하는 대표적인 언어 : JS,Python, Ruby

### 프로세스의 상태
![image](https://github.com/CodeWave-Summer-Edition/CSMaster/assets/43038815/e9fec77d-6759-492c-90cf-42099da54dc0)
- Running

    CPU를 잡고 명령어를 수행중인 상태
- Ready

    CPU를 잡기 위해 메모리에 올라와있는 상태
- Blocked( wait, sleep)

    CPU를 할당해도 명령어를 수행하지 못하는 상태
    
    자신이 요청한 event가 만족되지 않아서 이를 기다리는 상태
    
    ex) Disk에서 file을 읽어와야 하는 경우
- Suspended (stopped)

    외부적인 이유로 프로세스의 수행이 정지된 상태
    
    프로세스는 통째로 디스크의 swap area에 swap out된다.
- New
    
    프로세스가 생성중인 상태
    
- Terminated
    
    수행이 끝난 상태

### 프로세스의 구조
프로세스가 메모리에 올라온 대기상태에 있다면, 아래와 같은 구조를 가집니다.
![image](https://github.com/CodeWave-Summer-Edition/CSMaster/assets/43038815/06b61e82-9bb2-4c53-9e72-58d243b019d1)

1. 스택
- 지역변수, 매개변수, 함수 공간 등이 저장되는 공간
2. 힙
- 개발자가 동적으로 할당한 데이터의 공간
3. data
- 전역변수, static 변수 등 프로그램이 사용하는 데이터 공간
4. code
- 개발자가 작성한 코드의 명령어들의 공간

### PCB
Process Control Block의 약자로, 운영체제가 각각의 프로세스를 관리하기 위해 프로세스마다 유지하는 정보

- OS가 관리상 사용하는 정보
    - Process state, Process ID, Process privilege
    - Scheduling information , Priority
- CPU 수행 관련 하드웨어 값
    - Program Counter, Registers
- 메모리 관련
    - Code, Data, Stack의 위치정보
- 파일관련
    - Open File Descriptors

### Context Switch
단일 CPU는 한번에 한가지의 명령어밖에 처리를 하지 못함. 

하지만 운영체제의 시분할 시스템을 위해서 단일 CPU는 짧은 시간에 여러 프로세스들의 정보를 참조해가며 명령어를 수행해야함.

따라서 CPU의 소유권이 한 프로세스에서 다른 프로세스로 넘어가기 위해서, 실행중이던 PCB에 현재까지의 상태를 저장하고, 소유권이 넘어갈 프로세스의 PCB 정보를 읽어온 뒤 셋팅하는 과정이 필요함. 이를 Context Switch 라고한다.

## Multi Processing
**여러개의 Process를 통해 두 가지 이상의 작업을 수행할 수 있는 방법. 혹은 하나 이상의 작업을 병렬적으로 처리할 수 있다.**

### IPC(Inter Process Communication)
**프로세스끼리 데이터를 공유하는 메커니즘, 공유데이터를 관리하는 메커니즘을 뜻함.**

1. 공유 메모리   
![image](https://github.com/CodeWave-Summer-Edition/CSMaster/assets/43038815/b75bd780-fd78-4a76-b631-488a30222e65)
- 여러 프로세스가 동일한 메모리 블록에 대한 접근 권한이 부여되어 서로 통신할 수 있도록 공유 버퍼를 생성하는 방법.
- 프로세스간 데이터를 주고받는것이 아닌, 메모리 자체를 공유하기 때문에 빠르다.
- 메모리 자체를 공유하기때문에 동기화가 필요함

2. 파일
- 파일을 기반으로 프로세스 간 통신하는 방법

3. 소켓
- 네트워크 인터페이스를 통해 데이터를 전송하여 공유

4. 파이프
![image](https://github.com/CodeWave-Summer-Edition/CSMaster/assets/43038815/88e5d060-4c58-4beb-8d8a-46be41a5beb8)
- 프로세스간에 FIFO방식으로 읽히는 임시 공간인 파이프를 기반으로 데이터를 주고받는 형식.

5. 메시지 큐
![image](https://github.com/CodeWave-Summer-Edition/CSMaster/assets/43038815/fe56e81d-70c4-4a3b-8857-9a61f22e21f2)
- 메세지를 Queue 데이터 구조 형태로 관리하는 방법을 의미.

## Thread
**프로세스의 실행 가능한 가장 작은 작업 단위**
- 프로세스는 여러개의 Thread를 가질 수 있다.
- Thread는 Heap, Code, Data 영역을 공유한다.
- Thread는 독립적인 PC, Register set, stack 을 갖는다.

### Thread의 장점
- 응답성 (Responsiveness)
    
    다중 Thread를 이용하면 사용자에 대한 응답성을 증가시킬 수 있다.
- 자원 공유 (Resource Sharing)

    IPC 없이 Process 내의 자원과 메모리를 공유하기 때문에 자원 공유에 용이하다.

- 경제성 (Economy)

    자신이 속한 프로세스의 자원을 공유하기 때문에, Thread 생성 및 Context Switch 비용이 Process에 비해 경제적이다.

- Multi Processor 구조의 유틸성 (Utilization of MP Architectures)

    멀티코어에서는 각각의 스레드가 각기 다른 코어에서 병렬적으로 수행이 가능하다.

## Multi Threading
![image](https://github.com/CodeWave-Summer-Edition/CSMaster/assets/43038815/0cac407f-f646-4f65-ab9f-8eb8b00a5f26)
**프로세스 내 작업을 여러개의 Thread로 처리하는 방법.**
- Process의 자원을 Thread끼리 공유하기 때문에 IPC와 같이 리소스가 큰 작업이 필요없음
- 한 Thread가 중단되어도 다른 Thread는 실행상태일 수 있기 때문에 빠른 처리가 가능함.
- Multi Processing에 비해 Context switch에 소모되는 리소스가 적기때문에 동시성이 뛰어나다.